!function(v){"use strict";var o=function(i,e){this.$element=v(i),this.originalPosition={},this.originalElement={},this.$body=v("html body"),this.$doc=v(document),r(o.Defaults,e),this.options=v.extend({},o.Defaults,e),d(this.options,e),this.currentDialog="",this.currentDialogID="",this.init()};o.Version="1.1.0",o.Defaults={title:"Dialog",width:470,height:220,minWidth:150,minHeight:150,closeOnEscape:!0,resizable:!0,menus:[{text:"munu1",type:"nmenu",subMenus:[{text:"submenu1",fn:function(){}}],fn:function(){}}],buttons:[{id:"",text:"btn1",fn:function(){}}],close:function(i){}},o.prototype.init=function(){var i=this,e=(i.options,"JDialog_"+n(i));i.currentDialogID=e,l(i),t(i),s(i),a(i)},o.prototype.show=function(){var i=.5*v(window).width()-.5*this.currentDialog.width(),e=.5*v(window).height()-.5*this.currentDialog.height();this.currentDialog.css({left:i,top:e}),this.$body.append("<div class='JDialog-backdrop'></div>"),this.$body.addClass("JDialog-open"),this.currentDialog.show(),b(this)},o.prototype.hide=function(){this.currentDialog.hide(),this.$body.find(".JDialog-backdrop").remove(),this.$body.removeClass("JDialog-open")},o.prototype.destroy=function(){var i,e=this.originalPosition;(i=e.parent.children().eq(e.index)).length&&i[0]!==this.originalElement[0]?i.before(this.originalElement):e.parent.append(this.originalElement),this.currentDialog.remove(),this.$body.find(".JDialog-backdrop").remove(),this.$body.removeClass("JDialog-open")};var t=function(i){var e=i.options,t=[],n=e.width;n=n<e.minWidth?e.minWidth:n;var o=e.height;if(o=o<e.minHeight?e.minHeight:o,t.push(h("<div id='{0}' class='JDialog' tabindex='-1' style='display:none;'>",i.currentDialogID)),t.push(h("<div class='JDialog-dialog' style='width:{0};height:{1}'>",n+"px",o+"px")),t.push(h("<div class='JDialog-resizable-handle {0}'></div>",e.resizable?"JDialog-resizable-n":"")),t.push(h("<div class='JDialog-resizable-handle {0}'></div>",e.resizable?"JDialog-resizable-e":"")),t.push(h("<div class='JDialog-resizable-handle {0}'></div>",e.resizable?"JDialog-resizable-s":"")),t.push(h("<div class='JDialog-resizable-handle {0}'></div>",e.resizable?"JDialog-resizable-w":"")),t.push(h("<div class='JDialog-resizable-handle {0}'></div>",e.resizable?"JDialog-resizable-se":"")),t.push(h("<div class='JDialog-resizable-handle {0}'></div>",e.resizable?"JDialog-resizable-sw":"")),t.push("<div class='JDialog-content'>"),t.push("<div class='JDialog-header'>"),t.push("<button type='button' class='close'><span>×</span></button>"),t.push(h("<h4 class='JDialog-title'>{0}</h4>",e.title)),t.push("</div>"),0<e.menus.length){t.push("<div class='JDialog-menu'>"),t.push("<ul class='JDialog-menu-list'>");for(var a=0;a<e.menus.length;a++){var s=e.menus[a];switch(s.type){case"nmenu":t.push(h("<li class='JDialog-menu-item'><div class='nmenu'><a class='btn btn-default'><span>{0}</span></a></div></li>",s.text));break;case"ddmenu":t.push(h("<li class='JDialog-menu-item'><div class='ddmenu'><a class='btn btn-default'><span>{0}</span><span class='caret'></span></a></div></li>",s.text));break;case"sddmenu":t.push(h("<li class='JDialog-menu-item'><div class='sddmenu'><a class='btn btn-default'><span>{0}</span></a>|<a class='btn btn-default'><span class='caret'></span></a></div></li>",s.text))}}t.push("</ul>"),t.push("</div>")}t.push("<div class='JDialog-body'>"),t.push(i.$element.clone().show().prop("outerHTML")),t.push("</div>"),0<e.buttons.length&&(t.push("<div class='JDialog-footer'>"),v.each(e.buttons,function(i,e){t.push(h("<button class='btn btn-default' id='{1}'>{0}</button>",e.text,e.id))}),t.push("</div>")),t.push("</div>"),t.push("</div>"),t.push("</div>"),i.$body.append(t.join("")),i.originalPosition={parent:i.$element.parent(),index:i.$element.parent().children().index(i.$element)},i.originalElement=i.$element.clone(),i.$element.remove(),i.currentDialog=v("#"+i.currentDialogID),i.$element=i.currentDialog.find(".JDialog-content .JDialog-body").children().eq(0)},n=function(i){var e=i.$body.children(".JDialog"),o=[];return e.each(function(i,e){var t=v(e),n=parseInt(t.attr("id").replace("JDialog_",""));o.push(n)}),(o.length?u(o):0)+1},a=function(D){var m=D.options;D.currentDialog.find(".JDialog-header").off().mouseover(function(){v(this).css("cursor","move")}).mousedown(function(i){var e=!0,t=i.pageX-v(this).parent().offset().left,n=i.pageY-v(this).parent().offset().top;D.$doc.mousemove(function(i){e&&D.currentDialog.offset({left:i.pageX-t,top:i.pageY-n})}).mouseup(function(){e=!1,D.$doc.off("mousemove mouseup")})}),m.resizable&&D.currentDialog.find(".JDialog-dialog .JDialog-resizable-handle").off().mousedown(function(i){var n,o,a,s,l,r,d,u,h,c,g,p=v(this),f=p.attr("class").split(" ")[1].split("-")[2];c=!0,s=p.parent(".JDialog-dialog").offset().top,o=i.pageY,l=p.parent(".JDialog-dialog").outerHeight(),h=p.parent(".JDialog-dialog").offset().left,u=i.pageX,g=p.parent(".JDialog-dialog").outerWidth(),D.$doc.mousemove(function(i){if(c)switch(n=i.pageY,r=i.pageX,d=r-u,a=n-o,f){case"n":e=(e=l-a)<m.minHeight?m.minHeight:e,p.parent(".JDialog-dialog").height(e+"px"),p.parents(".JDialog").css("top",s+l-e+"px"),b(D);break;case"e":t=(t=g+d)<m.minWidth?m.minWidth:t,p.parent(".JDialog-dialog").width(t+"px");break;case"s":e=(e=l+a)<m.minHeight?m.minHeight:e,p.parent(".JDialog-dialog").height(e+"px"),b(D);break;case"w":t=(t=g-d)<m.minWidth?m.minWidth:t,p.parent(".JDialog-dialog").width(t+"px"),p.parents(".JDialog").css("left",h+(g-t)+"px");break;case"se":t=(t=g+d)<m.minWidth?m.minWidth:t,e=(e=l+a)<m.minHeight?m.minHeight:e,p.parent(".JDialog-dialog").width(t+"px"),p.parent(".JDialog-dialog").height(e+"px"),b(D);break;case"sw":var e,t;e=(e=l+a)<m.minHeight?m.minHeight:e,t=(t=g-d)<m.minWidth?m.minWidth:t,p.parent(".JDialog-dialog").width(t+"px"),p.parent(".JDialog-dialog").height(e+"px"),p.parents(".JDialog").css("left",h+(g-t)+"px"),b(D)}}).mouseup(function(i){c=!1,i.preventDefault(),i.stopPropagation(),D.$doc.off("mousemove mouseup")})})},s=function(e){var n=e.options;e.currentDialog.find("div.JDialog-content div.JDialog-header button.close").off("click").on("click",function(i){e.hide(),n.close&&"function"==typeof n.close&&n.close(i)}),e.currentDialog.find("div.JDialog-content div.JDialog-footer button").off("click").on("click",function(){var t=v(this).attr("id");v.grep(n.buttons,function(i,e){if(i.id==t)return!0},!1)[0].fn(this,event)}),e.currentDialog.on("keydown",function(i){n.closeOnEscape&&27==i.keyCode&&(e.hide(),n.close&&"function"==typeof n.close&&n.close(event))})},b=function(i){i.options;var e=(i.currentDialog.find(".JDialog-dialog").height()-(i.currentDialog.find(".JDialog-body").outerHeight()-i.currentDialog.find(".JDialog-body").height())-i.currentDialog.find(".JDialog-header").outerHeight()-i.currentDialog.find(".JDialog-menu").outerHeight()-i.currentDialog.find(".JDialog-footer").outerHeight()).toString()+"px";i.currentDialog.find(".JDialog-body").height(e)};var r=function(i,e){for(var t in e)if(e.hasOwnProperty(t)&&v.isArray(e[t])&&i.hasOwnProperty(t)){for(var n=[],o=e[t],a=0;a<o.length;a++){var s=o[a],l=v.extend(!0,{},i[t][0],s);d(l,s),n.push(l)}e[t]=n}else v.isPlainObject(e[t])&&r(i[t],e[t])},d=function(i,e){for(var t in i)i.hasOwnProperty(t)&&v.isArray(i[t])&&!e.hasOwnProperty(t)?i[t]=[]:v.isPlainObject(i[t])&&r(i[t],e[t])},l=function(i){var e=i.options,t=new Date,n=("0"+(t.getMonth()+1)).slice(-2)+("0"+t.getDate()).slice(-2),o=i.currentDialogID.replace(/^.+_/g,"");0<e.buttons.length&&v.each(e.buttons,function(i,e){if(""==e.id){Math.ceil(100*Math.random());var t=o+n+i;e.id=t}})},u=function(i){for(var e=i[0],t=i.length,n=1;n<t;n++)i[n]>e&&(e=i[n]);return e},h=function(i){var t=arguments;return i.replace(/\{(\d+)\}/g,function(i,e){return e=parseInt(e),t[e+1]})},i=v.fn.jDialog;v.fn.jDialog=function(n){return this.each(function(){var i,e=v(this),t="object"==typeof n&&n;(i=e.data("bsmodal"))||(i=new o(this,t)).$element.data("bsmodal",i);if("string"==typeof n){if(v.inArray(n,["show","hide","destroy"])<0)return console.error(h('方法:jDialog("{0}")不存在!',n)),!1;i[n]()}})},v.fn.jDialog.Constructor=o,v.fn.jDialog.noConflict=function(){return v.fn.jDialog=i,this}}(jQuery);