!function(v){"use strict";var o=function(i,t){this.$element=v(i),this.originalPosition={},this.originalElement={},this.$body=v("html body"),this.$doc=v(document),r(o.Defaults,t),this.options=v.extend({},o.Defaults,t),u(this.options,t),this.currentDialog="",this.currentDialogID="",this.init()};o.Version="1.1.0",o.Defaults={title:"Dialog",width:470,height:220,minWidth:150,minHeight:150,closeOnEscape:!0,resizable:!0,autoOpen:!0,menus:[{text:"munu1",type:"nmenu",subMenus:[{text:"submenu1",fn:function(){}}],fn:function(){}}],statusBar:[{index:0,halign:"left",text:""}],buttons:[{text:"btn1",fn:function(){}}],close:function(i){}},o.prototype.init=function(){var i=this,t=(i.options,"JDialog_"+n(i));i.currentDialogID=t,l(i),e(i),s(i),a(i)},o.prototype.show=function(){var i=.5*v(window).width()-.5*this.currentDialog.width(),t=.5*v(window).height()-.5*this.currentDialog.height();this.currentDialog.css({left:i,top:t}),this.$body.append("<div class='JDialog-backdrop'></div>"),this.$body.addClass("JDialog-open"),this.currentDialog.show(),this.currentDialog.focus(),b(this)},o.prototype.hide=function(){this.currentDialog.hide(),this.$body.find(".JDialog-backdrop").remove(),this.$body.removeClass("JDialog-open")},o.prototype.destroy=function(){var i,t=this.originalPosition;(i=t.parent.children().eq(t.index)).length&&i[0]!==this.originalElement[0]?i.before(this.originalElement):t.parent.append(this.originalElement),this.currentDialog.remove(),this.$body.find(".JDialog-backdrop").remove(),this.$body.removeClass("JDialog-open")},o.prototype.updateStatusBar=function(i){console.log(i);var s=this.options.statusBar,t=v("div.JDialog-statusbar ul.JDialog-statusbar-list li.JDialog-statusbar-item");v.each(i,function(i,o){t.each(function(i,t){var e=v(t);if(e.is("[data-index='"+o.index+"']")){var n=e.attr("data-origintext"),a=o.text.join(",");if(/\{(\d+)\}/g.test(n))a=n.replace(/\{(\d+)\}/g,function(i,t){return t=parseInt(t),o.text[t]});e.find("span").eq(0).text(a),v.grep(s,function(i,t){return i.index==o.index})[0].text=a}})})};var e=function(i){var t=i.options,n=[],e=t.width;e=e<t.minWidth?t.minWidth:e;var a=t.height;if(a=a<t.minHeight?t.minHeight:a,n.push(h("<div id='{0}' class='JDialog' tabindex='-1' style='display:none;'>",i.currentDialogID)),n.push(h("<div class='JDialog-dialog' style='width:{0};height:{1}'>",e+"px",a+"px")),n.push(h("<div class='JDialog-resizable-handle {0}'></div>",t.resizable?"JDialog-resizable-n":"")),n.push(h("<div class='JDialog-resizable-handle {0}'></div>",t.resizable?"JDialog-resizable-e":"")),n.push(h("<div class='JDialog-resizable-handle {0}'></div>",t.resizable?"JDialog-resizable-s":"")),n.push(h("<div class='JDialog-resizable-handle {0}'></div>",t.resizable?"JDialog-resizable-w":"")),n.push(h("<div class='JDialog-resizable-handle {0}'></div>",t.resizable?"JDialog-resizable-se":"")),n.push(h("<div class='JDialog-resizable-handle {0}'></div>",t.resizable?"JDialog-resizable-sw":"")),n.push("<div class='JDialog-content'>"),n.push("<div class='JDialog-header'>"),n.push("<button type='button' class='close'><span>Ã—</span></button>"),n.push(h("<h4 class='JDialog-title'>{0}</h4>",t.title)),n.push("</div>"),0<t.menus.length){n.push("<div class='JDialog-menu'>"),n.push("<ul class='JDialog-menu-list'>");for(var o=0;o<t.menus.length;o++){var s=[],l=t.menus[o];switch(l.type){case"nmenu":n.push(h("<li class='JDialog-menu-item' data-index='{1}'><div class='nmenu'><a class='btn btn-default'><span>{0}</span></a></div></li>",l.text,o));break;case"ddmenu":if(0<l.subMenus.length){s.push("<ul class='JDialog-submenu-list'>");for(var r=0;r<l.subMenus.length;r++){var u=l.subMenus[r],d=o.toString()+"-"+r.toString();s.push(h("<li class='JDialog-submenu-item' data-index='{1}'><a>{0}</a></li>",u.text,d))}s.push("</ul>")}n.push(h("<li class='JDialog-menu-item' data-index='{1}'><div class='ddmenu'><a class='btn btn-default'><span>{0}</span><span class='caret'></span></a></div>{2}</li>",l.text,o,s.join("")));break;case"sddmenu":if(0<l.subMenus.length){s.push("<ul class='JDialog-submenu-list'>");for(r=0;r<l.subMenus.length;r++){u=l.subMenus[r],d=o.toString()+"-"+r.toString();s.push(h("<li class='JDialog-submenu-item' data-index='{1}'><a>{0}</a></li>",u.text,d))}s.push("</ul>")}n.push(h("<li class='JDialog-menu-item' data-index='{1}'><div class='sddmenu'><a class='btn btn-default'><span>{0}</span></a>|<a class='btn btn-default'><span class='caret'></span></a></div>{2}</li>",l.text,o,s.join("")))}}n.push("</ul>"),n.push("</div>")}if(n.push("<div class='JDialog-body'>"),n.push(i.$element.clone().show().prop("outerHTML")),n.push("</div>"),0<t.statusBar.length){n.push("<div class='JDialog-statusbar'>");var g=v.grep(t.statusBar,function(i,t){return"left"==i.halign}),c=v.grep(t.statusBar,function(i,t){return"right"==i.halign});0<g.length&&(n.push("<div class='JDialog-left-statusbar'><ul class='JDialog-statusbar-list'>"),v.each(g,function(i,t){var e=t.text.replace(/\{(\d+)\}/g,"");n.push(h("<li class='JDialog-statusbar-item' data-index='{2}' data-origintext='{0}'><span>{1}</span></li>",t.text,e,t.index))}),n.push("</ul></div>")),0<c.length&&(n.push("<div class='JDialog-right-statusbar'><ul class='JDialog-statusbar-list'>"),v.each(c,function(i,t){var e=t.text.replace(/\{(\d+)\}/g,"");n.push(h("<li class='JDialog-statusbar-item' data-index='{2}' data-origintext='{0}'><span>{1}</span></li>",t.text,e,t.index))}),n.push("</ul></div>")),n.push("<div style='clear:both;'></div>"),n.push("</div>")}0<t.buttons.length&&(n.push("<div class='JDialog-footer'>"),v.each(t.buttons,function(i,t){n.push(h("<button class='btn btn-default' data-index='{1}'>{0}</button>",t.text,i))}),n.push("</div>")),n.push("</div>"),n.push("</div>"),n.push("</div>"),i.$body.append(n.join("")),i.originalPosition={parent:i.$element.parent(),index:i.$element.parent().children().index(i.$element)},i.originalElement=i.$element.clone(),i.$element.remove(),i.currentDialog=v("#"+i.currentDialogID),i.$element=i.currentDialog.find(".JDialog-content .JDialog-body").children().eq(0)},n=function(i){var t=i.$body.children(".JDialog"),a=[];return t.each(function(i,t){var e=v(t),n=parseInt(e.attr("id").replace("JDialog_",""));a.push(n)}),(a.length?d(a):0)+1},a=function(D){var m=D.options;D.currentDialog.find(".JDialog-header").off().mouseover(function(){v(this).css("cursor","move")}).mousedown(function(i){var t=!0,e=i.pageX-v(this).parent().offset().left,n=i.pageY-v(this).parent().offset().top;D.$doc.mousemove(function(i){t&&D.currentDialog.offset({left:i.pageX-e,top:i.pageY-n})}).mouseup(function(){t=!1,D.$doc.off("mousemove mouseup")})}),m.resizable&&D.currentDialog.find(".JDialog-dialog .JDialog-resizable-handle").off().mousedown(function(i){var n,a,o,s,l,r,u,d,g,c,h,p=v(this),f=p.attr("class").split(" ")[1].split("-")[2];c=!0,s=p.parent(".JDialog-dialog").offset().top,a=i.pageY,l=p.parent(".JDialog-dialog").outerHeight(),g=p.parent(".JDialog-dialog").offset().left,d=i.pageX,h=p.parent(".JDialog-dialog").outerWidth(),D.$doc.mousemove(function(i){if(c)switch(n=i.pageY,r=i.pageX,u=r-d,o=n-a,f){case"n":t=(t=l-o)<m.minHeight?m.minHeight:t,p.parent(".JDialog-dialog").height(t+"px"),p.parents(".JDialog").css("top",s+l-t+"px"),b(D);break;case"e":e=(e=h+u)<m.minWidth?m.minWidth:e,p.parent(".JDialog-dialog").width(e+"px");break;case"s":t=(t=l+o)<m.minHeight?m.minHeight:t,p.parent(".JDialog-dialog").height(t+"px"),b(D);break;case"w":e=(e=h-u)<m.minWidth?m.minWidth:e,p.parent(".JDialog-dialog").width(e+"px"),p.parents(".JDialog").css("left",g+(h-e)+"px");break;case"se":e=(e=h+u)<m.minWidth?m.minWidth:e,t=(t=l+o)<m.minHeight?m.minHeight:t,p.parent(".JDialog-dialog").width(e+"px"),p.parent(".JDialog-dialog").height(t+"px"),b(D);break;case"sw":var t,e;t=(t=l+o)<m.minHeight?m.minHeight:t,e=(e=h-u)<m.minWidth?m.minWidth:e,p.parent(".JDialog-dialog").width(e+"px"),p.parent(".JDialog-dialog").height(t+"px"),p.parents(".JDialog").css("left",g+(h-e)+"px"),b(D)}}).mouseup(function(i){c=!1,i.preventDefault(),i.stopPropagation(),D.$doc.off("mousemove mouseup")})})},s=function(o){var e,s=o.options;o.currentDialog.find("div.JDialog-content div.JDialog-header button.close").off("click").on("click",function(i){o.hide(),s.close&&"function"==typeof s.close&&s.close(i)}),o.currentDialog.find("div.JDialog-content div.JDialog-footer button").off("click").on("click",function(){var e=v(this).attr("data-index");v.grep(s.buttons,function(i,t){if(t==e)return!0},!1)[0].fn(this,event)}),o.currentDialog.on("keydown",function(i){s.closeOnEscape&&27==i.keyCode&&(o.hide(),s.close&&"function"==typeof s.close&&s.close(event))}),o.currentDialog.find("div.JDialog-content div.JDialog-menu a.btn").off("click").on("click",function(){var i=v(this);if(!(i.parents().is(".ddmenu")||i.parents().is(".sddmenu")&&i.children().is(".caret"))){var e=i.parents("li.JDialog-menu-item").attr("data-index");v.grep(s.menus,function(i,t){if(t==e)return!0},!1)[0].fn(this,event)}}),o.currentDialog.find("div.JDialog-content div.JDialog-menu ul.JDialog-submenu-list li.JDialog-submenu-item a").off("click").on("click",function(){var i=v(this);o.currentDialog.find("div.JDialog-content div.JDialog-menu ul.JDialog-submenu-list").hide();var t=i.parents("li.JDialog-submenu-item").attr("data-index").split("-"),e=t[0],n=t[1],a=v.grep(s.menus,function(i,t){if(t==e)return!0},!1);(a=v.grep(a[0].subMenus,function(i,t){if(t==n)return!0},!1))[0].fn(this,event)}),o.currentDialog.find("div.JDialog-content div.JDialog-menu a.btn").hover(function(){var i=v(this);if(o.currentDialog.find("div.JDialog-content div.JDialog-menu ul.JDialog-submenu-list").hide(),i.parents().is(".ddmenu")||i.parents().is(".sddmenu")&&i.children().is(".caret")){var t=i.parents("li.JDialog-menu-item").find("ul.JDialog-submenu-list");0<t.find("li.JDialog-submenu-item").length&&(e&&(clearTimeout(e),e=!1),t.show())}},function(){var i=v(this);if(i.parents().is(".ddmenu")||i.parents().is(".sddmenu")&&i.children().is(".caret")){var t=i.parents("li.JDialog-menu-item").find("ul.JDialog-submenu-list");0<t.find("li.JDialog-submenu-item").length&&(e&&(clearTimeout(e),e=!1),e=setTimeout(function(){t.hide()},300))}}),o.currentDialog.find("div.JDialog-content div.JDialog-menu ul.JDialog-submenu-list").hover(function(){var i=v(this);e&&(clearTimeout(e),e=!1),i.show()},function(){var i=v(this);e&&(clearTimeout(e),e=!1),e=setTimeout(function(){i.hide()},300)})},b=function(i){i.options;var t=(i.currentDialog.find(".JDialog-dialog").height()-(i.currentDialog.find(".JDialog-body").outerHeight()-i.currentDialog.find(".JDialog-body").height())-i.currentDialog.find(".JDialog-header").outerHeight()-i.currentDialog.find(".JDialog-menu").outerHeight()-i.currentDialog.find(".JDialog-statusbar").outerHeight()-i.currentDialog.find(".JDialog-footer").outerHeight()).toString()+"px";i.currentDialog.find(".JDialog-body").height(t)};var r=function(i,t){for(var e in t)if(t.hasOwnProperty(e)&&v.isArray(t[e])&&i.hasOwnProperty(e)){for(var n=[],a=t[e],o=0;o<a.length;o++){var s=a[o],l=v.extend(!0,{},i[e][0],s);u(l,s),n.push(l)}t[e]=n}else v.isPlainObject(t[e])&&r(i[e],t[e])},u=function(i,t){for(var e in i)i.hasOwnProperty(e)&&v.isArray(i[e])&&!t.hasOwnProperty(e)?i[e]=[]:v.isPlainObject(i[e])&&u(i[e],t[e])},l=function(i){var t=i.options;0<t.statusBar.length&&v.each(t.statusBar,function(i,t){t.index=i})},d=function(i){for(var t=i[0],e=i.length,n=1;n<e;n++)i[n]>t&&(t=i[n]);return t},h=function(i){var e=arguments;return i.replace(/\{(\d+)\}/g,function(i,t){return t=parseInt(t),e[t+1]})},i=v.fn.jDialog;v.fn.jDialog=function(n,a){return this.each(function(){var i,t=v(this),e="object"==typeof n&&n;(i=t.data("jDialog"))||(i=new o(this,e)).$element.data("jDialog",i);"string"==typeof n&&i&&i[n]?i[n](a):i.options.autoOpen&&i.show()})},v.fn.jDialog.Constructor=o,v.fn.jDialog.noConflict=function(){return v.fn.jDialog=i,this}}(jQuery);