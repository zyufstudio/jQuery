(function(e){"use strict";function t(t){return this.each(function(){var n=e(this),o="object"==typeof t&&t,s=n.data("boxselect");if(!s){s=new i(this,o);n.data("boxselect",s)}})}var i=function(t,n){this.$element=e(t),this.$head=e("html head"),this.$body=e("html body"),this.$doc=e(document),this.$selectBox={},this.options=e.extend({},i.Defaults,n),this.init()};i.Defaults={},i.prototype.init=function(){var t=this,i=(t.options,0),s=0,c=!1;n(t);var u=e('<div class="select-box"></div>');t.$body.append(u),t.$selectBox=u,t.$element.on({mousedown:function(e){c=!0,i=e.pageX,s=e.pageY,t.$selectBox.css({left:i,top:s}),r(e)},mousemove:function(e){if(c&&1===e.which){var n=e.pageX,l=e.pageY;o(t,i,n,s,l),a(t),r(e)}},mouseup:function(e){l(t),c=!1}}),t.$doc.off("mouseup").on({mouseup:function(e){l(t),c=!1}})};var n=function(e){var t=".select-box {position: absolute;display: none;width: 0px;height: 0px;padding: 0px;margin: 0px;border: 1px dashed #0099ff;background-color: #c3d5ed;opacity: 0.5;filter: alpha(opacity=50);font-size: 0px;z-index: 99999;pointer-events: none;}";t="<style>"+t+"</style>",e.$head.append(t)},o=function(e,t,i,n,o){e.$selectBox.show();var s=Math.min(i,t),c=Math.min(o,n),a=Math.abs(i-t),l=Math.abs(o-n);e.$selectBox.css({left:s,top:c,width:a,height:l})},s=function(e){var t=e.offset().left,i=e.offset().top,n=t+e.outerWidth(),o=i+e.outerHeight();return{x1:t,x2:n,y1:i,y2:o}},c=function(e,t){var i=!0,n=!0;return i=e.x1>t.x2||t.x1>e.x2,n=e.y1>t.y2||t.y1>e.y2,!(i||n)},a=function(t){t.options;var i=s(t.$selectBox);t.$element.find(".select-item").each(function(){var t=e(this),n=s(t);c(i,n)?t.is(".select-item.selected-item")?t.removeClass("selected-item selecting-item").addClass("unselecting-item"):t.is(".select-item.unselecting-item")||t.addClass("selecting-item"):t.is(".select-item.unselecting-item")?t.addClass("selected-item").removeClass("unselecting-item"):t.removeClass("selecting-item")})},l=function(e){e.options;e.$element.find(".select-item.selecting-item").removeClass("selecting-item").addClass("selected-item"),e.$element.find(".select-item.unselecting-item").removeClass("selecting-item selected-item unselecting-item"),e.$selectBox.hide()},r=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1},u=e.fn.JBoxSelect;e.fn.JBoxSelect=t,e.fn.JBoxSelect.Constructor=i,e.fn.JBoxSelect.noConflict=function(){return e.fn.JBoxSelect=u,this},void 0===String.prototype.format&&(String.prototype.format=function(){var e=arguments;return this.replace(/\{(\d+)\}/g,function(t,i){return e[i]})}),void 0===Array.prototype.max&&(Array.prototype.max=function(){for(var e=this[0],t=this.length,i=1;i<t;i++)this[i]>e&&(e=this[i]);return e})})(jQuery);